(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{536:function(s,a,t){"use strict";t.r(a);var n=t(15),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),t("h2",{attrs:{id:"docker-理念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-理念"}},[s._v("#")]),s._v(" Docker 理念")]),s._v(" "),t("blockquote",[t("p",[s._v("Docker的主要目标是“Build，Ship and Run Any App,Anywhere”，也就是通过对应用组件的封装、分发、部署、运行等生命周期的管理，使用户的APP（可以是一个WEB应用或数据库应用等等）及其运行环境能够做到“一次封装，到处运行”。解决了运行环境和配置问题软件容器，方便做持续集成并有助于整体发布的容器虚拟化技术。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195048442.png",alt:"image-20220129195048442"}})]),s._v(" "),t("h2",{attrs:{id:"linux容器的实现方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#linux容器的实现方式"}},[s._v("#")]),s._v(" Linux容器的实现方式")]),s._v(" "),t("blockquote",[t("p",[s._v("一个正在运行的 Docker 容器，其实就是一个启用了多个 Linux Namespace 的应用进程，而这个进程能够使用的资源量，则受 Cgroups 配置的限制。这也是容器技术中一个非常重要的概念，即：容器是一个“单进程”模型。")])]),s._v(" "),t("p",[s._v("一个“容器”，实际上是一个由 Linux Namespace、Linux Cgroups 和 rootfs 三种技术构建出来的进程的隔离环境。")]),s._v(" "),t("ol",[t("li",[t("p",[t("strong",[s._v("Namespace")]),s._v(" 的作用是“隔离”，它让应用进程只能看到该 Namespace 内的“世界”；修改进程视图的主要方法")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("Cgroups")]),s._v(" 的作用是“限制”，它给这个“世界”围上了一圈看不见的墙。制造约束的主要手段")])]),s._v(" "),t("li",[t("p",[s._v("一组联合挂载在 /var/lib/docker/aufs/mnt 上的 "),t("strong",[s._v("rootfs")]),s._v("，这一部分我们称为“容器镜像”（Container Image），是容器的静态视图；一个由 Namespace+Cgroups 构成的隔离环境，这一部分我们称为“容器运行时”（Container Runtime），是容器的动态视图。")])])]),s._v(" "),t("h3",{attrs:{id:"namespace"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#namespace"}},[s._v("#")]),s._v(" NameSpace")]),s._v(" "),t("p",[s._v("在容器中看到只有自己一个进程，但是这个进程其实是在宿主机上的 只不过是一个独立的namespace")]),s._v(" "),t("p",[s._v("定义了5个命名空间结构体，多个进程可以使用同一个namespace")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("UTS： 运行内核的名称、版本、底层体系结构类型等信息（UNIX Timesharing System）")])]),s._v(" "),t("li",[t("p",[s._v("IPC： 与进程间通信（IPC)有关")])]),s._v(" "),t("li",[t("p",[s._v("MNT：已经装载的文件系统的视图 Mount Namespace，用于让被隔离进程只看到当前 Namespace 里的挂载点信息；")])]),s._v(" "),t("li",[t("p",[s._v("PID：有关进程ID的信息")])]),s._v(" "),t("li",[t("p",[s._v("NET：网络相关的命名空间参数 Network Namespace，用于让被隔离进程看到当前 Namespace 里的网络设备和配置。")])])]),s._v(" "),t("p",[s._v("在 Linux 内核中，有很多资源和对象是不能被 Namespace 化的，最典型的例子就是："),t("strong",[s._v("时间")]),s._v("。")]),s._v(" "),t("p",[s._v("为了让多个容器以沙盒的方式在宿主机上运行，就需要提前定义好各个容器能看到的边界。由于各个容器都是直接运行在宿主机系统上，因此需要内核对各个容器的上下文进行修改，让他们看上去是一个独立的操作系统。比如，指定PID为1的进程，指定网卡设备，指定文件系统挂载，指定用户等等。")]),s._v(" "),t("p",[s._v("Linux操作系统内核从底层实现了为各个进程创建独立用户空间的功能，不同用户空间似于一个个独立的虚拟机系统，用户空间内部进程不能感知到其它用户空间中的进程状态。内核提供了六种Namespaces。")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("UTS")]),s._v(" "),t("th",[s._v("hostname and domainname")]),s._v(" "),t("th",[s._v("主机名和域名隔离")]),s._v(" "),t("th",[s._v("内核版本：2.6.19")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("User")]),s._v(" "),t("td"),s._v(" "),t("td",[s._v("用户隔离。运行进程的用户和组")]),s._v(" "),t("td",[s._v("内核版本：3.8.x")])]),s._v(" "),t("tr",[t("td",[s._v("Mount")]),s._v(" "),t("td"),s._v(" "),t("td",[s._v("挂载点隔离。即挂载点隔离，主要指根目录")]),s._v(" "),t("td",[s._v("内核版本：2.4.19")])]),s._v(" "),t("tr",[t("td",[s._v("IPC")]),s._v(" "),t("td",[s._v("Inter-process-connection")]),s._v(" "),t("td",[s._v("进程间通信隔离。消息队列、共享内容、信号量")]),s._v(" "),t("td",[s._v("内核版本：2.6.19")])]),s._v(" "),t("tr",[t("td",[s._v("Pid")]),s._v(" "),t("td",[s._v("Process")]),s._v(" "),t("td"),s._v(" "),t("td")]),s._v(" "),t("tr",[t("td",[s._v("ID")]),s._v(" "),t("td"),s._v(" "),t("td",[s._v("PID隔离")]),s._v(" "),t("td")]),s._v(" "),t("tr",[t("td",[s._v("Net")]),s._v(" "),t("td",[s._v("Network")]),s._v(" "),t("td",[s._v("网络隔离。网络设备、协议栈、端口")]),s._v(" "),t("td",[s._v("内核版本：2.6.29")])])])]),s._v(" "),t("h3",{attrs:{id:"cgroups"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cgroups"}},[s._v("#")]),s._v(" Cgroups")]),s._v(" "),t("p",[s._v("Linux Cgroups 就是 Linux 内核中用来为进程设置资源限制的一个重要功能。")]),s._v(" "),t("p",[s._v("Linux Cgroups 的全称是 Linux Control Group。它最主要的作用，就是限制一个进程组能够使用的资源上限，包括 CPU、内存、磁盘、网络带宽等等。")]),s._v(" "),t("p",[s._v("此外，Cgroups 还能够对进程进行优先级设置、审计，以及将进程挂起和恢复等操作。")]),s._v(" "),t("h3",{attrs:{id:"chroot"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#chroot"}},[s._v("#")]),s._v(" Chroot")]),s._v(" "),t("p",[s._v("如果需要在一个宿主机上运行多个容器，且容器之间相互隔离，那么第一个就需要系统库文件的依赖，对于一个容器而言，需要将其需要的系统文件单独复制出来一份，放到指定目录，并且需要让进程认为这就是根目录，而不是去调用宿主机系统上的库文件。Chroot就是一个切换根目录的方式。")]),s._v(" "),t("h2",{attrs:{id:"docker和虚拟机的区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker和虚拟机的区别"}},[s._v("#")]),s._v(" Docker和虚拟机的区别")]),s._v(" "),t("p",[s._v("比较了 Docker 和传统虚拟化方式的不同之处：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("传统虚拟机技术是虚拟出一套硬件后，在其上运行一个完整操作系统，在该系统上再运行所需应用进程；")])]),s._v(" "),t("li",[t("p",[s._v("而容器内的应用进程直接运行于宿主的内核，容器内没有自己的内核， 而且也没有进行硬件虚拟。因此容器要比传统虚拟机更为轻便。")])]),s._v(" "),t("li",[t("p",[s._v("每个容器之间互相隔离，每个容器有自己的文件系统 ，容器之间进程不会相互影响，能区分计算资源。")])])]),s._v(" "),t("h3",{attrs:{id:"虚拟机"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#虚拟机"}},[s._v("#")]),s._v(" 虚拟机")]),s._v(" "),t("p",[s._v("它可以在一种操作系统里面运行另一种操作系统，比如在Windows 系统里面运行Linux 系统。应用程序对此毫无感知，因为虚拟机看上去跟真实系统一模一样，而对于底层系统来说，虚拟机就是一个普通文件，不需要了就删掉，对其他部分毫无影响。这类虚拟机完美的运行了另一套系统，能够使应用程序，操作系统和硬件三者之间的逻辑不变。")]),s._v(" "),t("p",[s._v("虚拟机的缺点：")]),s._v(" "),t("ul",[t("li",[s._v("资源占用多")]),s._v(" "),t("li",[s._v("冗余步骤多")]),s._v(" "),t("li",[s._v("启动慢")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195103937.png",alt:"image-20220129195103937"}})]),s._v(" "),t("h3",{attrs:{id:"docker-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-2"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),t("p",[s._v("Linux 容器不是模拟一个完整的操作系统，而是对进程进行隔离。有了容器，就可以将软件运行所需的所有资源打包到一个隔离的容器中。容器与虚拟机不同，不需要捆绑一整套操作系统，只需要软件工作所需的库资源和设置。系统因此而变得高效轻量并保证部署在任何环境中的软件都能始终如一地运行。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195116807.png",alt:"image-20220129195116807"}})]),s._v(" "),t("h2",{attrs:{id:"docker的优势"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker的优势"}},[s._v("#")]),s._v(" Docker的优势")]),s._v(" "),t("p",[s._v("Docker是一个Client-Server结构的系统，Docker守护进程运行在主机上， 然后通过Socket连接从客户端访问，守护进程从客户端接受命令并管理运行在主机上的容器。 容器，是一个运行时环境，就是我们前面说到的集装箱。docker有着比虚拟机更少的抽象层。由亍docker不需要Hypervisor实现硬件资源虚拟化,运行在docker容器上的程序直接使用的都是实际物理机的硬件资源。因此在CPU、内存利用率上docker将会在效率上有明显优势。docker利用的是宿主机的内核,而不需要Guest OS。因此,当新建一个容器时,docker不需要和虚拟机一样重新加载一个操作系统内核。仍而避免引寻、加载操作系统内核返个比较费时费资源的过程,当新建一个虚拟机时,虚拟机软件需要加载Guest OS,返个新建过程是分钟级别的。而docker由于直接利用宿主机的操作系统,则省略了返个过程,因此新建一个docker容器只需要几秒钟。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195134595.png",alt:"image-20220129195134595"}})]),s._v(" "),t("h2",{attrs:{id:"相关概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#相关概念"}},[s._v("#")]),s._v(" 相关概念")]),s._v(" "),t("p",[s._v("需要正确的理解仓储/镜像/容器这几个概念:")]),s._v(" "),t("p",[s._v("Docker 本身是一个容器运行载体或称之为管理引擎。我们把应用程序和配置依赖打包好形成一个可交付的运行环境，这个打包好的运行环境就似乎 image镜像文件。只有通过这个镜像文件才能生成 Docker 容器。image 文件可以看作是容器的模板。Docker 根据 image 文件生成容器的实例。同一个 image 文件，可以生成多个同时运行的容器实例。")]),s._v(" "),t("ul",[t("li",[s._v("image 文件生成的容器实例，本身也是一个文件，称为镜像文件。")]),s._v(" "),t("li",[s._v("一个容器运行一种服务，当我们需要的时候，就可以通过docker客户端创建一个对应的运行实例，也就是我们的容器")]),s._v(" "),t("li",[s._v("至于仓储，就是放了一堆镜像的地方，我们可以把镜像发布到仓储中，需要的时候从仓储中拉下来就可以了。")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195154025.png",alt:"image-20220129195154025"}})]),s._v(" "),t("h3",{attrs:{id:"镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#镜像"}},[s._v("#")]),s._v(" 镜像")]),s._v(" "),t("p",[s._v("Docker 镜像（Image）就是一个只读的模板。镜像可以用来创建 Docker 容器，一个镜像可以创建很多容器。")]),s._v(" "),t("p",[s._v("docker镜像的命名标准：")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("${registry_ name}/${repository. name}/${image. name}:${tag. name}\ndocker.io/library/alpine:3.10.1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#容器"}},[s._v("#")]),s._v(" 容器")]),s._v(" "),t("p",[s._v("Docker 利用容器（Container）独立运行的一个或一组应用。容器是用镜像创建的运行实例。")]),s._v(" "),t("p",[s._v("它可以被启动、开始、停止、删除。每个容器都是相互隔离的、保证安全的平台。\n"),t("strong",[s._v("可以把容器看做是一个简易版的 Linux 环境")]),s._v("（包括root用户权限、进程空间、用户空间和网络空间等）和运行在其中的应用程序。")]),s._v(" "),t("p",[s._v("容器的定义和镜像几乎一模一样，也是一堆层的统一视角，唯一区别在于容器的最上面那一层是可读可写的。")]),s._v(" "),t("h3",{attrs:{id:"仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#仓库"}},[s._v("#")]),s._v(" 仓库")]),s._v(" "),t("p",[s._v("仓库（Repository）是集中存放镜像文件的场所。")]),s._v(" "),t("p",[s._v("仓库(Repository)和仓库注册服务器（Registry）是有区别的。仓库注册服务器上往往存放着多个仓库，每个仓库中又包含了多个镜像，每个镜像有不同的标签（tag）。")]),s._v(" "),t("p",[s._v("仓库分为公开仓库（Public）和私有仓库（Private）两种形式。")]),s._v(" "),t("p",[s._v("最大的公开仓库是 "),t("a",{attrs:{href:"https://hub.docker.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker Hub"),t("OutboundLink")],1),s._v("，存放了数量庞大的镜像供用户下载。国内的公开仓库包括阿里云 、网易云等。")]),s._v(" "),t("h2",{attrs:{id:"centos安装docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#centos安装docker"}},[s._v("#")]),s._v(" Centos安装Docker")]),s._v(" "),t("h3",{attrs:{id:"_1-卸载旧版本docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-卸载旧版本docker"}},[s._v("#")]),s._v(" 1. 卸载旧版本Docker")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-client "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-client-latest "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-common "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-latest "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-latest-logrotate "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-logrotate "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n                  docker-engine\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h3",{attrs:{id:"_2-设置镜像仓库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-设置镜像仓库"}},[s._v("#")]),s._v(" 2. 设置镜像仓库")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum-config-manager "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --add-repo "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    https://download.docker.com/linux/centos/docker-ce.repo\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"_3-安装docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装docker"}},[s._v("#")]),s._v(" 3. 安装Docker")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce docker-ce-cli containerd.io docker-compose-plugin\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_4-配置镜像加速"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-配置镜像加速"}},[s._v("#")]),s._v(" 4. 配置镜像加速")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /etc/docker\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" /etc/docker/daemon.json "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'EOF\'\n{\n  "registry-mirrors": ["https://t9rco7kp.mirror.aliyuncs.com"]\n}\nEOF')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl daemon-reload\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 其他配置")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# daemon.json 配置介绍")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"graph"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/data/docker"')]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"storage-driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"overlay2"')]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"insecure-registries"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry.access.redhat.com"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"quay.io"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://q2gr04ke.mirror.aliyuncs.com>"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bip"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.24.38.1/24"')]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exec-opts"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"native.cgroupdriver=systemd"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"live-restore"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置项注意点：")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# graph: 该关键字未来将被弃用，可以采用 "data-root" 替代')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# storage-driver: 存储驱动，即分层文件系统")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# insecure-registries: 不安全的docker registries，即使用http协议推拉镜象")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# registry-mirrors: 加速站点，一般可以使用阿里、网易云、docker中国(<https://registry.docker-cn.com>)的地址")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bip: 指定docker bridge地址(不能以.0结尾)，生产中建议采用 172.xx.yy.1/24,其中xx.yy为宿主机ip后四位，方便定位问题")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 若启动失败，查看 /var/log/message 日志排错")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h3",{attrs:{id:"_5-启动docker并测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-启动docker并测试"}},[s._v("#")]),s._v(" 5. 启动Docker并测试")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run hello-world\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"_6-docker-run逻辑图"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-docker-run逻辑图"}},[s._v("#")]),s._v(" 6. Docker Run逻辑图")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195215440.png",alt:"image-20220129195215440"}})]),s._v(" "),t("h3",{attrs:{id:"_99-卸载方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_99-卸载方式"}},[s._v("#")]),s._v(" 99. 卸载方式")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("systemctl stop "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" \nyum -y remove docker-ce\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /var/lib/docker\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"docker-常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-常用命令"}},[s._v("#")]),s._v(" Docker 常用命令")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195228538.png",alt:"image-20220129195228538"}})]),s._v(" "),t("h3",{attrs:{id:"帮助相关"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#帮助相关"}},[s._v("#")]),s._v(" 帮助相关")]),s._v(" "),t("h4",{attrs:{id:"查看版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看版本"}},[s._v("#")]),s._v(" 查看版本")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195243064.png",alt:"image-20220129195243064"}})]),s._v(" "),t("h4",{attrs:{id:"查看docker信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看docker信息"}},[s._v("#")]),s._v(" 查看docker信息")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195255915.png",alt:"image-20220129195255915"}})]),s._v(" "),t("h4",{attrs:{id:"查看帮助"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看帮助"}},[s._v("#")]),s._v(" 查看帮助")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" --help\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"镜像相关命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#镜像相关命令"}},[s._v("#")]),s._v(" 镜像相关命令")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.查看本机中所有镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\t--------------------------\t列出本地所有镜像\n-a\t\t\t列出所有镜像（包含中间映像层）\n-q\t\t\t只显示镜像id\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.搜索镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 镜像名\t-------------------\t去dockerhub上查询当前镜像\n-s 指定值\t\t列出收藏数不少于指定值的镜像\n--no-trunc\t  显示完整的镜像信息\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.从仓库下载镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull 镜像名"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":TAG"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("@DIGEST"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\t----------------- 下载镜像\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.删除镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi 镜像名\t--------------------------  删除镜像\n-f\t\t强制删除\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h4",{attrs:{id:"登录退出dockerhub"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#登录退出dockerhub"}},[s._v("#")]),s._v(" 登录退出DockerHub")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" login docker.io\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /root/.docker/config.json\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195311257.png",alt:"image-20220129195311257"}})]),s._v(" "),t("h4",{attrs:{id:"列举系统上的镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#列举系统上的镜像"}},[s._v("#")]),s._v(" 列举系统上的镜像")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\noptions：\n\t-a   显示本机所有镜像\n\t-q   只显示id\n\t--digest  只显示摘要信息\n\t--no-trunc 显示完整镜像信息\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h4",{attrs:{id:"查找镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查找镜像"}},[s._v("#")]),s._v(" 查找镜像")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search xxx\noptions:\n\t--no-strunc 显示完整的镜像信息\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h4",{attrs:{id:"拉取镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#拉取镜像"}},[s._v("#")]),s._v(" 拉取镜像")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull xxx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(":版本"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"删除镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除镜像"}},[s._v("#")]),s._v(" 删除镜像")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi xxx\n\neg.\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi centos 删除一个镜像\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi centos:latest centos:7.1 删除多个\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images -aq"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" 删除全部\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" rmi -f xxx 强制删除\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h4",{attrs:{id:"镜像标签"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#镜像标签"}},[s._v("#")]),s._v(" 镜像标签")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag d4ff818577bc docker.io/zhangsan404/alpine:latest\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195329232.png",alt:"image-20220129195329232"}})]),s._v(" "),t("h4",{attrs:{id:"推送镜像到远端"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#推送镜像到远端"}},[s._v("#")]),s._v(" 推送镜像到远端")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push docker.io/zhangsan404/alpine:latest\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"保存镜像到本地"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#保存镜像到本地"}},[s._v("#")]),s._v(" 保存镜像到本地")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" save zhangsan404/alpine:test "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" alpine_test.tar\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195339070.png",alt:"image-20220129195339070"}})]),s._v(" "),t("h4",{attrs:{id:"本地镜像导入"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#本地镜像导入"}},[s._v("#")]),s._v(" 本地镜像导入")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" load "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" alpine_test.tar\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195349934.png",alt:"image-20220129195349934"}})]),s._v(" "),t("h3",{attrs:{id:"容器相关命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#容器相关命令"}},[s._v("#")]),s._v(" 容器相关命令")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.运行容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run 镜像名\t--------------------------\t镜像名新建并启动容器\n--name \t\t\t\t\t别名为容器起一个名字\n-d\t\t\t\t\t\t\t启动守护式容器（在后台启动容器）\n-p \t\t\t\t\t\t\t映射端口号：原始端口号\t\t 指定端口号启动\n\n例：docker run -it --name myTomcat -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(":8080 tomcat\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d --name myTomcat -P tomcat\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.查看运行的容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\t\t\t\t\t--------------------------\t列出所有正在运行的容器\n-a\t\t\t正在运行的和历史运行过的容器\n-q\t\t\t静默模式，只显示容器编号\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.停止|关闭|重启容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start   容器名字或者容器id  --------------- 开启容器\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart 容器名或者容器id    --------------- 重启容器\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop  容器名或者容器id \t    ------------------ 正常停止容器运行\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v("  容器名或者容器id      ------------------ 立即停止容器运行\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.删除容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f 容器id和容器名     \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -aq"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\t\t--------------------------\t删除所有容器\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5.查看容器内进程")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" 容器id或者容器名 ------------------ 查看容器内的进程\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 6.查看查看容器内部细节")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect 容器id \t\t------------------ 查看容器内部细节\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 7.查看容器的运行日志")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 容器id或容器名\t------------------ 查看容器日志\n-t\t\t\t 加入时间戳\n-f\t\t\t 跟随最新的日志打印\n--tail \t 数字\t显示最后多少条\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 8.进入容器内部")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 容器id 容器内命令 ------------------ 进入容器执行命令\n-i\t\t以交互模式运行容器，通常与-t一起使用\n-t\t\t分配一个伪终端    shell窗口   "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 9.容器和宿主机之间复制文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" 文件"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("目录 容器id:容器路径           -----------------   将宿主机复制到容器内部\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" 容器id:容器内资源路径 宿主机目录路径  -----------------   将容器内资源拷贝到主机上\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 10.数据卷(volum)实现与宿主机共享目录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -v 宿主机的路径"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("任意别名:/容器内的路径 镜像名\n注意: \n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".如果是宿主机路径必须是绝对路径,宿主机目录会覆盖容器内目录内容\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".如果是别名则会在docker运行容器时自动在宿主机中创建一个目录,并将容器目录文件复制到宿主机中\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 11.打包镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" save 镜像名 -o  名称.tar\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 12.载入镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" load -i   名称.tar\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 13.容器打包成新的镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit -m "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"描述信息"')]),s._v(" -a "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"作者信息"')]),s._v("   （容器id或者名称）打包的镜像名称:标签\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br")])]),t("h4",{attrs:{id:"新建并运行容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#新建并运行容器"}},[s._v("#")]),s._v(" 新建并运行容器")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" IMAGE "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("COMMAND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ARG"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\noptions：\n--name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"容器新名字"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" 为容器指定一个名称；\n-d: 后台运行容器，并返回容器ID，也即启动守护式容器；\n-i：以交互模式运行容器，通常与 -t 同时使用；\n-t：为容器重新分配一个伪输入终端，通常与 -i 同时使用；\n-P: 随机端口映射；\n-p: 指定端口映射，有以下四种格式\n      ip:hostPort:containerPort\n      ip::containerPort\n      **hostPort:containerPort**\n      containerPort\n\ne.g.\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name centos_demo01 -t -i centos  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 交互式方式运行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d --name tomcat_demo01 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v(":8080 tomcat "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 后台运行")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h4",{attrs:{id:"查看容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看容器"}},[s._v("#")]),s._v(" 查看容器")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\noptions:\n\t-a    查看所有容器包括正在运行和停止的\n\t-q    显示id\n  -n    显示最近创建的n个容器\n\t-l    显示最近创建的容器\n\t--no-stunc    不截断输出\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h4",{attrs:{id:"退出容器的两种方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#退出容器的两种方式"}},[s._v("#")]),s._v(" 退出容器的两种方式")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器停止")]),s._v("\nCTRL+p+q\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h4",{attrs:{id:"容器的启动、停止、重启、强制关闭"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#容器的启动、停止、重启、强制关闭"}},[s._v("#")]),s._v(" 容器的启动、停止、重启、强制关闭")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start xxx \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop xxx\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart xxx\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" xxx\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"删除容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除容器"}},[s._v("#")]),s._v(" 删除容器")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -aq"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制删除全部容器               = docker ps -qa |Xargs docker rm -f")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"查看容器日志"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看容器日志"}},[s._v("#")]),s._v(" 查看容器日志")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" 容器id\noptions：\n\t-t 时间戳\n\t-f 跟随最新日志\n\t--tail 数字后显示多少条\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h4",{attrs:{id:"查看容器内进程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看容器内进程"}},[s._v("#")]),s._v(" 查看容器内进程")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" 容器id\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"查看容器内部细节"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看容器内部细节"}},[s._v("#")]),s._v(" 查看容器内部细节")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect 容器id\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"重新进入正在运行的容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重新进入正在运行的容器"}},[s._v("#")]),s._v(" 重新进入正在运行的容器")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it 容器id /bin/bash  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打开新的终端   新进程 以这种方式进入exit不会结束容器的运行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" attach 容器id   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 直接进入容器启动的命令行终端")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h4",{attrs:{id:"文件相互拷贝"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#文件相互拷贝"}},[s._v("#")]),s._v(" 文件相互拷贝")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" 容器id:容器路径 本机路径\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" 本机路径 容器id:容器内路径\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h4",{attrs:{id:"将容器保存为镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#将容器保存为镜像"}},[s._v("#")]),s._v(" 将容器保存为镜像")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("docker commit -p 容器名称 docker.io/zhangsan404/alpine:test_01\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"镜像-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#镜像-2"}},[s._v("#")]),s._v(" 镜像")]),s._v(" "),t("h3",{attrs:{id:"unionfs-联合文件系统"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#unionfs-联合文件系统"}},[s._v("#")]),s._v(" UnionFS - 联合文件系统")]),s._v(" "),t("blockquote",[t("p",[s._v("UnionFS（联合文件系统）：Union文件系统（UnionFS）是一种分层、轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下(unite several directories into a single virtual filesystem)。Union 文件系统是 Docker 镜像的基础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。")])]),s._v(" "),t("h3",{attrs:{id:"docker镜像加载原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker镜像加载原理"}},[s._v("#")]),s._v(" Docker镜像加载原理")]),s._v(" "),t("p",[s._v("docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统UnionFS。")]),s._v(" "),t("p",[s._v("bootfs(boot file system)主要包含bootloader和kernel, bootloader主要是引导加载kernel, Linux刚启动时会加载bootfs文件系统，在Docker镜像的最底层是bootfs。这一层与我们典型的Linux/Unix系统是一样的，包含boot加载器和内核。当boot加载完成之后整个内核就都在内存中了，此时内存的使用权已由bootfs转交给内核，此时系统也会卸载bootfs。")]),s._v(" "),t("p",[s._v("rootfs (root file system) ，在bootfs之上。包含的就是典型 Linux 系统中的 /dev, /proc, /bin, /etc 等标准目录和文件。rootfs就是各种不同的操作系统发行版，比如Ubuntu，Centos等等。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195408200.png",alt:"image-20220129195408200"}})]),s._v(" "),t("h3",{attrs:{id:"docker-commit"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-commit"}},[s._v("#")]),s._v(" Docker commit")]),s._v(" "),t("blockquote",[t("p",[s._v("Docker commit 可以将一个容器打包为镜像。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit -m"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"描述信息"')]),s._v(" -a"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"作者"')]),s._v(" 容器id 镜像名称:tag\n\ne.g.\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit -m"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tomcat with demo/helloworld"')]),s._v(" -a"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jm"')]),s._v(" 0179893d97e7 jm/tomcat:1.2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195424220.png",alt:"image-20220129195424220"}})]),s._v(" "),t("h2",{attrs:{id:"容器数据卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#容器数据卷"}},[s._v("#")]),s._v(" 容器数据卷")]),s._v(" "),t("blockquote",[t("p",[s._v("Docker容器产生的数据，如果不通过docker commit生成新的镜像，使得数据做为镜像的一部分保存下来，那么当容器删除后，数据自然也就没有了。 为了能保存数据在docker中我们使用容器数据卷。")])]),s._v(" "),t("p",[s._v("卷就是目录或文件，存在于一个或多个容器中，由docker挂载到容器，但不属于联合文件系统，因此能够绕过Union File System提供一些用于持续存储或共享数据的特性。")]),s._v(" "),t("p",[s._v("卷的设计目的就是数据的持久化，完全独立于容器的生存周期，因此Docker不会在容器删除时删除其挂载的数据卷")]),s._v(" "),t("p",[s._v("特点：")]),s._v(" "),t("p",[s._v("1：数据卷可在容器之间共享或重用数据\n2：卷中的更改可以直接生效\n3：数据卷中的更改不会包含在镜像的更新中\n4：数据卷的生命周期一直持续到没有容器使用它为止")]),s._v(" "),t("h3",{attrs:{id:"命令行创建容器数据卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命令行创建容器数据卷"}},[s._v("#")]),s._v(" 命令行创建容器数据卷")]),s._v(" "),t("h4",{attrs:{id:"创建容器卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建容器卷"}},[s._v("#")]),s._v(" 创建容器卷")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -ti --name demo01 -v ~/myfile:/opt:ro centos:latest "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 带权限")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"查看容器卷挂载情况"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看容器卷挂载情况"}},[s._v("#")]),s._v(" 查看容器卷挂载情况")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect demo01  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器详细信息")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195436762.png",alt:"image-20220129195436762"}})]),s._v(" "),t("h3",{attrs:{id:"dockerfile创建容器数据卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile创建容器数据卷"}},[s._v("#")]),s._v(" Dockerfile创建容器数据卷")]),s._v(" "),t("ol",[t("li",[s._v("创建一个文件夹")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" MyDockerfile\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("创建Dockerfile文件")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" Dockerfile\n\nFROM centos   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导入centos镜像")]),s._v("\nVOLUME "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dataVolumeContainer1"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dataVolumeContainer2"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建两个容器数据卷，由于主机的文件夹无法指定，这里的容器数据卷只有docker方向的")]),s._v("\nCMD "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"finished,--------success1"')]),s._v("\nCMD /bin/bash  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行bash")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("构建容器")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build -f dockerfile位置 -t 输出的镜像名称 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当前目录")]),s._v("\n\ne.g.\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build -f ~/MyDockerfile/Dockerfile -t jm/centos_jm:1.1 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195459345.png",alt:"image-20220129195459345"}})]),s._v(" "),t("p",[s._v("默认主机端数据卷对接位置：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195510155.png",alt:"image-20220129195510155"}})]),s._v(" "),t("h3",{attrs:{id:"数据卷容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数据卷容器"}},[s._v("#")]),s._v(" 数据卷容器")]),s._v(" "),t("blockquote",[t("p",[s._v("命名的容器挂载数据卷，其它容器通过挂载这个(父容器)实现数据共享，挂载数据卷的容器，称之为数据卷容器")])]),s._v(" "),t("p",[s._v("创建父容器")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -ti --name dc01 jm/jm_centos:1.0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("创建子容器")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -ti --name dc02 --volumes-from dc01 jm/jm_centos:1.0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("子容器和父容器共享数据卷，当父容器删除时，子容器内容不会删除。可以理解为容器和数据卷分离，容器没了，数据卷还在。")]),s._v(" "),t("h2",{attrs:{id:"docker安装常见的服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker安装常见的服务"}},[s._v("#")]),s._v(" Docker安装常见的服务")]),s._v(" "),t("h3",{attrs:{id:"docker-安装-mysql"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装-mysql"}},[s._v("#")]),s._v(" Docker 安装 Mysql")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.拉取mysql镜像到本地")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql:tag "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tag不加默认最新版本"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.运行mysql服务")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name mysql -e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root -d mysql:tag  \t\t\t\t\t\t  --没有暴露外部端口外部不能连接\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name mysql -e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 -d  mysql:tag  --没有暴露外部端口\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.进入mysql容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it 容器名称"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器id "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.外部查看mysql日志")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs 容器名称"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器id\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5.使用自定义配置参数")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name mysql -v /root/mysql/conf.d:/etc/mysql/conf.d -e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root -d mysql:tag\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 6.将容器数据位置与宿主机位置挂载保证数据安全")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name mysql -v /root/mysql/data:/var/lib/mysql -v /root/mysql/conf.d:/etc/mysql/conf.d -e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 -d mysql:tag\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 7.通过其他客户端访问 如在window系统|macos系统使用客户端工具访问")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 8.将mysql数据库备份为sql文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器id "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'exec mysqldump --all-databases -uroot -p\"$MYSQL_ROOT_PASSWORD\"'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /root/all-databases.sql  --导出全部数据\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" mysql "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'exec mysqldump --databases 库表 -uroot -p\"$MYSQL_ROOT_PASSWORD\"'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /root/all-databases.sql  --导出指定库数据\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" mysql "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'exec mysqldump --no-data --databases 库表 -uroot -p\"$MYSQL_ROOT_PASSWORD\"'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /root/all-databases.sql  --导出指定库数据不要数据\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 9.执行sql文件到mysql中")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -i mysql "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'exec mysql -uroot -p\"$MYSQL_ROOT_PASSWORD\"'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" /root/xxx.sql\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h3",{attrs:{id:"docker安装redis"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker安装redis"}},[s._v("#")]),s._v(" Docker安装Redis")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.在docker hub搜索redis镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search redis\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.拉取redis镜像到本地")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull redis\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.启动redis服务运行容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name redis -d redis:tag "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("没有暴露外部端口"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name redis -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 -d redis:tag "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("暴露外部宿主机端口为6379进行连接"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.查看启动日志")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs -t -f 容器id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器名称\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5.进入容器内部查看")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it 容器id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("名称 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("  \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 6.加载外部自定义配置启动redis容器")]),s._v("\n默认情况下redis官方镜像中没有redis.conf配置文件 需要去官网下载指定版本的配置文件\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.redis.io/releases/redis-5.0.8.tar.gz  下载官方安装包\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". 将官方安装包中配置文件进行复制到宿主机指定目录中如 /root/redis/redis.conf文件\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(". 修改需要自定义的配置\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("bind")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0 开启远程权限\nappenonly "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v(" 开启aof持久化\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(". 加载配置启动\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name redis -v /root/redis:/usr/local/etc/redis -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 -d redis redis-server /usr/local/etc/redis/redis.conf  \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 7.将数据目录挂在到本地保证数据安全")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name redis -v /root/redis/data:/data -v /root/redis/redis.conf:/usr/local/etc/redis/redis.conf -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(":6379 -d redis redis-server \t\t\t\t\t/usr/local/etc/redis/redis.conf  \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("h3",{attrs:{id:"docker-安装-nginx"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装-nginx"}},[s._v("#")]),s._v(" Docker 安装 nginx")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.在docker hub搜索nginx")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search nginx\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.拉取nginx镜像到本地")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull nginx")]),s._v("\nUsing default tag: latest\nlatest: Pulling from library/nginx\nafb6ec6fdc1c: Pull complete \nb90c53a0b692: Pull complete \n11fa52a0fdc0: Pull complete \nDigest: sha256:30dfa439718a17baafefadf16c5e7c9d0a1cde97b4fd84f63b69e13513be7097\nStatus: Downloaded newer image "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" nginx:latest\ndocker.io/library/nginx:latest\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.启动nginx容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 --name nginx01 -d nginx\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.进入容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it nginx01 /bin/bash\n查找目录:  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("whereis")]),s._v(" nginx\n配置文件:  /etc/nginx/nginx.conf\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5.复制配置文件到宿主机")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" nginx01"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("容器id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("容器名称"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":/etc/nginx/nginx.conf 宿主机名录\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 6.挂在nginx配置以及html到宿主机外部")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run --name nginx02 -v /root/nginx/nginx.conf:/etc/nginx/nginx.conf -v /root/nginx/html:/usr/share/nginx/html -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(":80 -d nginx\t\t\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("h3",{attrs:{id:"docker-安装-tomcat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装-tomcat"}},[s._v("#")]),s._v(" Docker 安装 Tomcat")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.在docker hub搜索tomcat")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search tomcat\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.下载tomcat镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull tomcat\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.运行tomcat镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":8080 -d --name mytomcat tomcat\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.进入tomcat容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it mytomcat /bin/bash\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5.将webapps目录挂载在外部")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":8080 -v /root/webapps:/usr/local/tomcat/webapps -d --name mytomcat tomcat\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h3",{attrs:{id:"docker-安装-es"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-安装-es"}},[s._v("#")]),s._v(" Docker 安装 ES")]),s._v(" "),t("h4",{attrs:{id:"_0-拉取镜像-启动容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-拉取镜像-启动容器"}},[s._v("#")]),s._v(" 0. 拉取镜像 启动容器")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.dockerhub 拉取镜像")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull elasticsearch:6.4.2\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.查看docker镜像")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.运行docker镜像")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v(":9200 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9300")]),s._v(":9300 elasticsearch:6.4.2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220501134102408.png",alt:"image-20220501134102408"}})]),s._v(" "),t("h4",{attrs:{id:"_1-进行相关的配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-进行相关的配置"}},[s._v("#")]),s._v(" 1. 进行相关的配置")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.在centos虚拟机中，修改配置sysctl.conf")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/sysctl.conf\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.加入如下配置")]),s._v("\n\tvm.max_map_count"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("262144")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.启用配置")]),s._v("\n\tsysctl -p\n\t注：这一步是为了防止启动容器时，报出如下错误：\n\tbootstrap checks failed max virtual memory areas vm.max_map_count "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65530")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" likely too low, increase to at least "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("262144")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h4",{attrs:{id:"_2-启动容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-启动容器"}},[s._v("#")]),s._v(" 2. 启动容器")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 0.复制容器中data目录到宿主机中")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" 容器id:/usr/share/share/elasticsearch/data /root/es\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.运行ES容器 指定jvm内存大小并指定ik分词器位置")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d --name es -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v(":9200 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9300")]),s._v(":9300 -e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ES_JAVA_OPTS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-Xms128m -Xmx128m"')]),s._v(" -v /root/es/plugins:/usr/share/elasticsearch/plugins -v /root/es/data:/usr/share/elasticsearch/data elasticsearch:6.4.2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h4",{attrs:{id:"_3-安装ik分词器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-安装ik分词器"}},[s._v("#")]),s._v(" 3.安装IK分词器")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.下载对应版本的IK分词器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v6.4.2/elasticsearch-analysis-ik-6.4.2.zip\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.解压到plugins文件夹中")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v(" -d ik elasticsearch-analysis-ik-6.4.2.zip\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.添加自定义扩展词和停用词")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" plugins/elasticsearch/config\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" IKAnalyzer.cfg.xml\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("properties"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("comment"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("IK Analyzer 扩展配置"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/comment"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("--用户可以在这里配置自己的扩展字典 --"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("entry "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("key")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ext_dict"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("ext_dict.dic"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/entry"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("--用户可以在这里配置自己的扩展停止词字典--"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("entry "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("key")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ext_stopwords"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("ext_stopwords.dic"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/entry"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/properties"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.在ik分词器目录下config目录中创建ext_dict.dic文件   编码一定要为UTF-8才能生效")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" ext_dict.dic 加入扩展词即可\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5. 在ik分词器目录下config目录中创建ext_stopword.dic文件 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" ext_stopwords.dic 加入停用词即可\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 6.重启容器生效")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart 容器id\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 7.将此容器提交成为一个新的镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit -a"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xiaochen"')]),s._v(" -m"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"es with IKAnalyzer"')]),s._v(" 容器id xiaochen/elasticsearch:6.4.2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("h4",{attrs:{id:"_4-安装kibana"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-安装kibana"}},[s._v("#")]),s._v(" 4. 安装Kibana")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.下载kibana镜像到本地")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull kibana:6.4.2\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.启动kibana容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d --name kibana -e "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ELASTICSEARCH_URL")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://10.15.0.3:9200 -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5601")]),s._v(":5601 kibana:6.4.2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"docker-常见问题处置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-常见问题处置"}},[s._v("#")]),s._v(" Docker 常见问题处置")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker search mysql 或者 docker pull 这些命令无法使用")]),s._v("\nError response from daemon: Get https://index.docker.io/v1/search?q"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("n")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(": x509: certificate has expired or is not yet valid\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220501134345146.png",alt:"image-20220501134345146"}})]),s._v(" "),t("p",[s._v("注意:"),t("strong",[s._v("这个错误的原因在于是系统的时间和docker hub时间不一致,需要做系统时间与网络时间同步")])]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.安装时间同步")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum -y "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" ntp ntpdate\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.同步时间")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ntpdate cn.pool.ntp.org\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.查看本机时间")]),s._v("\n\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 4.从新测试")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"dockerfile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" Dockerfile")]),s._v(" "),t("blockquote",[t("p",[s._v("Dockerfile是用来构建Docker镜像的构建文件，是由一系列命令和参数构成的脚本。")])]),s._v(" "),t("h3",{attrs:{id:"什么是dockerfile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#什么是dockerfile"}},[s._v("#")]),s._v(" 什么是Dockerfile")]),s._v(" "),t("p",[s._v("Dockerfile可以认为是"),t("strong",[s._v("Docker镜像的描述文件，是由一系列命令和参数构成的脚本")]),s._v("。主要作用是"),t("strong",[s._v("用来构建docker镜像的构建文件")]),s._v("。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220501134810645.png",alt:"image-20220501134810645"}})]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("通过架构图可以看出通过DockerFile可以直接构建镜像")])])]),s._v(" "),t("h3",{attrs:{id:"dockerfile解析过程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile解析过程"}},[s._v("#")]),s._v(" Dockerfile解析过程")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220501134802852.png",alt:"image-20220501134802852"}})]),s._v(" "),t("h3",{attrs:{id:"dockerfile的保留命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile的保留命令"}},[s._v("#")]),s._v(" Dockerfile的保留命令")]),s._v(" "),t("p",[s._v("官方说明:https://docs.docker.com/engine/reference/builder/")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("保留字")]),s._v(" "),t("th",[s._v("作用")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[t("strong",[s._v("FROM")])]),s._v(" "),t("td",[t("strong",[s._v("当前镜像是基于哪个镜像的")]),s._v(" "),t("code",[s._v("第一个指令必须是FROM")])])]),s._v(" "),t("tr",[t("td",[s._v("MAINTAINER")]),s._v(" "),t("td",[s._v("镜像维护者的姓名和邮箱地址")])]),s._v(" "),t("tr",[t("td",[t("strong",[s._v("RUN")])]),s._v(" "),t("td",[t("strong",[s._v("构建镜像时需要运行的指令")])])]),s._v(" "),t("tr",[t("td",[t("strong",[s._v("EXPOSE")])]),s._v(" "),t("td",[t("strong",[s._v("当前容器对外暴露出的端口号")])])]),s._v(" "),t("tr",[t("td",[t("strong",[s._v("WORKDIR")])]),s._v(" "),t("td",[t("strong",[s._v("指定在创建容器后，终端默认登录进来的工作目录，一个落脚点")])])]),s._v(" "),t("tr",[t("td",[t("strong",[s._v("ENV")])]),s._v(" "),t("td",[t("strong",[s._v("用来在构建镜像过程中设置环境变量")])])]),s._v(" "),t("tr",[t("td",[t("strong",[s._v("ADD")])]),s._v(" "),t("td",[t("strong",[s._v("将宿主机目录下的文件拷贝进镜像且ADD命令会自动处理URL和解压tar包")])])]),s._v(" "),t("tr",[t("td",[t("strong",[s._v("COPY")])]),s._v(" "),t("td",[t("strong",[s._v("类似于ADD，拷贝文件和目录到镜像中"),t("br"),s._v("将从构建上下文目录中<原路径>的文件/目录复制到新的一层的镜像内的<目标路径>位置")])])]),s._v(" "),t("tr",[t("td",[t("strong",[s._v("VOLUME")])]),s._v(" "),t("td",[t("strong",[s._v("容器数据卷，用于数据保存和持久化工作")])])]),s._v(" "),t("tr",[t("td",[t("strong",[s._v("CMD")])]),s._v(" "),t("td",[t("strong",[s._v("指定一个容器启动时要运行的命令"),t("br"),s._v("Dockerfile中可以有多个CMD指令，但只有最后一个生效，CMD会被docker run之后的参数替换")])])]),s._v(" "),t("tr",[t("td",[t("strong",[s._v("ENTRYPOINT")])]),s._v(" "),t("td",[t("strong",[s._v("指定一个容器启动时要运行的命令"),t("br"),s._v("ENTRYPOINT的目的和CMD一样，都是在指定容器启动程序及其参数")])])])])]),s._v(" "),t("h4",{attrs:{id:"from"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#from"}},[s._v("#")]),s._v(" FROM")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("基于那个镜像进行构建新的镜像,在构建时会自动从docker hub拉取base镜像 必须作为Dockerfile的第一个指令出现")])]),s._v(" "),t("li",[t("p",[s._v("语法:")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("  <image>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("  <image>[:<tag>]     使用版本不写为latest")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("  <image>[@<digest>]  使用摘要")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])])]),s._v(" "),t("h4",{attrs:{id:"maintainer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#maintainer"}},[s._v("#")]),s._v(" MAINTAINER")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("镜像维护者的姓名和邮箱地址[废弃]")])]),s._v(" "),t("li",[t("p",[s._v("语法:")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("MAINTAINER")]),s._v(" <name>")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])]),s._v(" "),t("h4",{attrs:{id:"run"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#run"}},[s._v("#")]),s._v(" RUN")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("RUN指令将在当前映像之上的新层中执行任何命令并提交结果。生成的提交映像将用于Dockerfile中的下一步")])]),s._v(" "),t("li",[t("p",[s._v("语法:")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" <command> (shell form, the command is run in a shell, which by default is /bin/sh -c on Linux or cmd /S /C on Windows)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" echo hello")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"executable"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"param1"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"param2"')]),s._v("] (exec form)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-c"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo hello"')]),s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])])]),s._v(" "),t("h4",{attrs:{id:"expose"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#expose"}},[s._v("#")]),s._v(" EXPOSE")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("用来指定构建的镜像在运行为容器时对外暴露的端口")])]),s._v(" "),t("li",[t("p",[s._v("语法:")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 80/tcp  如果没有显示指定则默认暴露都是tcp")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 80/udp")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])]),s._v(" "),t("h4",{attrs:{id:"cmd"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cmd"}},[s._v("#")]),s._v(" CMD")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("用来为启动的容器指定执行的命令,在Dockerfile中只能有一条CMD指令。如果列出多个命令，则只有最后一个命令才会生效。")])]),s._v(" "),t("li",[t("p",[s._v("注意: "),t("strong",[s._v("Dockerfile中只能有一条CMD指令。如果列出多个命令，则只有最后一个命令才会生效。")])])]),s._v(" "),t("li",[t("p",[s._v("语法:")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"executable"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"param1"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"param2"')]),s._v("] (exec form, this is the preferred form)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"param1"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"param2"')]),s._v("] (as default parameters to ENTRYPOINT)")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" command param1 param2 (shell form)")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])])])]),s._v(" "),t("h4",{attrs:{id:"workdir"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#workdir"}},[s._v("#")]),s._v(" WORKDIR")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("用来为Dockerfile中的任何RUN、CMD、ENTRYPOINT、COPY和ADD指令设置工作目录。如果WORKDIR不存在，即使它没有在任何后续Dockerfile指令中使用，它也将被创建。")])]),s._v(" "),t("li",[t("p",[s._v("语法:")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /path/to/workdir")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /a")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" b")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" c")]),s._v("\n`注意:WORKDIR指令可以在Dockerfile中多次使用。如果提供了相对路径，则该路径将与先前WORKDIR指令的路径相对`\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])])])]),s._v(" "),t("h4",{attrs:{id:"env"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#env"}},[s._v("#")]),s._v(" ENV")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("用来为构建镜像设置环境变量。这个值将出现在构建阶段中所有后续指令的环境中。")])]),s._v(" "),t("li",[t("p",[s._v("语法：")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" <key> <value>")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENV")]),s._v(" <key>=<value> ...")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])]),s._v(" "),t("h4",{attrs:{id:"add"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#add"}},[s._v("#")]),s._v(" ADD")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("用来从context上下文复制新文件、目录或远程文件url，并将它们添加到位于指定路径的映像文件系统中。")])]),s._v(" "),t("li",[t("p",[s._v("语法:")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" hom* /mydir/       通配符添加多个文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" hom?.txt /mydir/   通配符添加")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" test.txt relativeDir/  可以指定相对路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" test.txt /absoluteDir/ 也可以指定绝对路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" url ")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])])])]),s._v(" "),t("h4",{attrs:{id:"copy"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#copy"}},[s._v("#")]),s._v(" COPY")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("用来将context目录中指定文件复制到镜像的指定目录中")])]),s._v(" "),t("li",[t("p",[s._v("语法:")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" src dest")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<src>"')]),s._v(",... "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"<dest>"')]),s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])]),s._v(" "),t("h4",{attrs:{id:"volume"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#volume"}},[s._v("#")]),s._v(" VOLUME")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("用来定义容器运行时可以挂在到宿主机的目录")])]),s._v(" "),t("li",[t("p",[s._v("语法:")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VOLUME")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/data"')]),s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])]),s._v(" "),t("h4",{attrs:{id:"entrypoint"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#entrypoint"}},[s._v("#")]),s._v(" ENTRYPOINT")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("用来指定容器启动时执行命令和CMD类似")])]),s._v(" "),t("li",[t("p",[s._v("语法:")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[s._v('  ["executable", "param1", "param2"]\n'),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" command param1 param2")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("ENTRYPOINT指令，往往用于设置容器启动后的"),t("strong",[s._v("第一个命令")]),s._v("，这对一个容器来说往往是固定的。\nCMD指令，往往用于设置容器启动的第一个命令的"),t("strong",[s._v("默认参数")]),s._v("，这对一个容器来说可以是变化的。")])])]),s._v(" "),t("h4",{attrs:{id:"onbuild"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#onbuild"}},[s._v("#")]),s._v(" ONBUILD")]),s._v(" "),t("p",[s._v("触发器，当构建一个被继承的Dockerfile时运行的命令，父镜像在被子镜像集成之后，onbuild被触发")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195611002.png",alt:"image-20220129195611002"}})]),s._v(" "),t("h3",{attrs:{id:"dockerfile-打包-springboot项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile-打包-springboot项目"}},[s._v("#")]),s._v(" Dockerfile 打包 Springboot项目")]),s._v(" "),t("h4",{attrs:{id:"_0-打包本地项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_0-打包本地项目"}},[s._v("#")]),s._v(" 0. 打包本地项目")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220501142139702.png",alt:"image-20220501142139702"}})]),s._v(" "),t("h4",{attrs:{id:"_1-将可运行项目放入linux虚拟机中"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-将可运行项目放入linux虚拟机中"}},[s._v("#")]),s._v(" 1. 将可运行项目放入linux虚拟机中")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220501142210304.png",alt:"image-20220501142210304"}})]),s._v(" "),t("h4",{attrs:{id:"_3-编写dockerfile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-编写dockerfile"}},[s._v("#")]),s._v(" 3. 编写dockerFile")]),s._v(" "),t("div",{staticClass:"language-dockerfile line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" openjdk:8")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /ems")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ADD")]),s._v(" ems.jar /ems")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 8989")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENTRYPOINT")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"java"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-jar"')]),s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ems.jar"')]),s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h4",{attrs:{id:"_4-构建运行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-构建运行"}},[s._v("#")]),s._v(" 4. 构建运行")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ems"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker build -t ems .")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ems"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -p 8989:8989 ems")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"本地镜像发布"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#本地镜像发布"}},[s._v("#")]),s._v(" 本地镜像发布")]),s._v(" "),t("div",{staticClass:"language-docker line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-docker"}},[t("code",[s._v("<https://cr.console.aliyun.com/cn-beijing/instance/repositories>\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220129195629643.png",alt:"image-20220129195629643"}})]),s._v(" "),t("p",[t("strong",[s._v("1. 登录阿里云Docker Registry")]),s._v(" "),t("code",[s._v("$ sudo docker login --username=153****2135 registry.cn-beijing.aliyuncs.com")])]),s._v(" "),t("p",[s._v("用于登录的用户名为阿里云账号全名，密码为开通服务时设置的密码。\n您可以在访问凭证页面修改凭证密码。")]),s._v(" "),t("h3",{attrs:{id:"_2-从registry中拉取镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-从registry中拉取镜像"}},[s._v("#")]),s._v(" 2. 从Registry中拉取镜像")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("$ sudo docker pull registry.cn-beijing.aliyuncs.com/csbugless/test:[镜像版本号]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"_3-将镜像推送到registry"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-将镜像推送到registry"}},[s._v("#")]),s._v(" 3. 将镜像推送到Registry")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("$ sudo docker login --username=153****2135 registry.cn-beijing.aliyuncs.com\n$ sudo docker tag [ImageId] registry.cn-beijing.aliyuncs.com/csbugless/test:[镜像版本号]\n$ sudo docker push registry.cn-beijing.aliyuncs.com/csbugless/test:[镜像版本号]\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("请根据实际镜像信息替换示例中的[ImageId]和[镜像版本号]参数。")]),s._v(" "),t("h3",{attrs:{id:"_4-选择合适的镜像仓库地址"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-选择合适的镜像仓库地址"}},[s._v("#")]),s._v(" 4. 选择合适的镜像仓库地址")]),s._v(" "),t("p",[s._v("从ECS推送镜像时，可以选择使用镜像仓库内网地址。推送速度将得到提升并且将不会损耗您的公网流量。")]),s._v(" "),t("p",[s._v("如果您使用的机器位于VPC网络，请使用 "),t("a",{attrs:{href:"http://registry-vpc.cn-beijing.aliyuncs.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("registry-vpc.cn-beijing.aliyuncs.com"),t("OutboundLink")],1),s._v(" 作为Registry的域名登录。")]),s._v(" "),t("h3",{attrs:{id:"_5-示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-示例"}},[s._v("#")]),s._v(" 5. 示例")]),s._v(" "),t("p",[s._v('使用"docker tag"命令重命名镜像，并将它通过专有网络地址推送至Registry。')]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("$ sudo docker imagesREPOSITORY                                                         TAG                 IMAGE ID            CREATED             VIRTUAL SIZEregistry.aliyuncs.com/acs/agent                                    0.7-dfb6816         37bb9c63c8b2        7 days ago          37.89 MB$ sudo docker tag 37bb9c63c8b2 registry-vpc.cn-beijing.aliyuncs.com/acs/agent:0.7-dfb6816\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v('使用 "docker push" 命令将该镜像推送至远程。')]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("$ sudo docker push registry-vpc.cn-beijing.aliyuncs.com/acs/agent:0.7-dfb6816\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"高级网络和容器卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#高级网络和容器卷"}},[s._v("#")]),s._v(" 高级网络和容器卷")]),s._v(" "),t("h3",{attrs:{id:"高级网络配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#高级网络配置"}},[s._v("#")]),s._v(" 高级网络配置")]),s._v(" "),t("h4",{attrs:{id:"说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[s._v("#")]),s._v(" 说明")]),s._v(" "),t("p",[s._v("当 Docker 启动时，会自动在主机上创建一个 "),t("code",[s._v("docker0")]),s._v(" 虚拟网桥，实际上是 Linux 的一个 bridge，可以理解为一个软件交换机。它会在挂载到它的网口之间进行转发。")]),s._v(" "),t("p",[s._v("同时，Docker 随机分配一个本地未占用的私有网段（在 "),t("a",{attrs:{href:"https://tools.ietf.org/html/rfc1918",target:"_blank",rel:"noopener noreferrer"}},[s._v("RFC1918"),t("OutboundLink")],1),s._v(" 中定义）中的一个地址给 "),t("code",[s._v("docker0")]),s._v(" 接口。比如典型的 "),t("code",[s._v("172.17.42.1")]),s._v("，掩码为 "),t("code",[s._v("255.255.0.0")]),s._v("。此后启动的容器内的网口也会自动分配一个同一网段（"),t("code",[s._v("172.17.0.0/16")]),s._v("）的地址。")]),s._v(" "),t("p",[s._v("当创建一个 Docker 容器的时候，同时会创建了一对 "),t("code",[s._v("veth pair")]),s._v(" 接口（当数据包发送到一个接口时，另外一个接口也可以收到相同的数据包）。这对接口一端在容器内，即 "),t("code",[s._v("eth0")]),s._v("；另一端在本地并被挂载到 "),t("code",[s._v("docker0")]),s._v(" 网桥，名称以 "),t("code",[s._v("veth")]),s._v(" 开头（例如 "),t("code",[s._v("vethAQI2QT")]),s._v("）。通过这种方式，主机可以跟容器通信，容器之间也可以相互通信。Docker 就创建了在主机和所有容器之间一个虚拟共享网络。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220501142520315.png",alt:"image-20220501142520315"}})]),s._v(" "),t("h4",{attrs:{id:"查看网络信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看网络信息"}},[s._v("#")]),s._v(" 查看网络信息")]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[t("span",{pre:!0,attrs:{class:"token title important"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v(" docker network ls")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"创建一个网桥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建一个网桥"}},[s._v("#")]),s._v(" 创建一个网桥")]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[t("span",{pre:!0,attrs:{class:"token title important"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v(" docker network create -d bridge 网桥名称")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"删除一个网桥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除一个网桥"}},[s._v("#")]),s._v(" 删除一个网桥")]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[t("span",{pre:!0,attrs:{class:"token title important"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("#")]),s._v(" docker network rm 网桥名称")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"容器之前使用网络通信"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#容器之前使用网络通信"}},[s._v("#")]),s._v(" 容器之前使用网络通信")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1.查询当前网络配置")]),s._v("\n- "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nNETWORK ID          NAME                DRIVER              SCOPE\n8e424e5936b7        bridge              bridge              "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n17d974db02da        docker_gwbridge     bridge              "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\nd6c326e433f7        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2.创建桥接网络")]),s._v("\n- "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" network create -d bridge info\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network create -d bridge info")]),s._v("\n6e4aaebff79b1df43a064e0e8fdab08f52d64ce34db78dd5184ce7aaaf550a2f\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker network ls")]),s._v("\nNETWORK ID          NAME                DRIVER              SCOPE\n8e424e5936b7        bridge              bridge              "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n17d974db02da        docker_gwbridge     bridge              "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\nd6c326e433f7        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n6e4aaebff79b        info                bridge              "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("local")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3.启动容器指定使用网桥")]),s._v("\n- "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8890")]),s._v(":80 --name nginx001 --network info nginx \n- "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8891")]),s._v(":80 --name nginx002 --network info nginx \n注意:一旦指定网桥后--name指定名字就是主机名,多个容器指定在同一个网桥时,可以在任意一个容器中使用主机名与容器进行互通\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -p 8890:80 --name nginx001 --network info nginx ")]),s._v("\nc315bcc94e9ddaa36eb6c6f16ca51592b1ac8bf1ecfe9d8f01d892f3f10825fe\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -p 8891:80 --name nginx002 --network info nginx")]),s._v("\nf8682db35dd7fb4395f90edb38df7cad71bbfaba71b6a4c6e2a3a525cb73c2a5\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES\nf8682db35dd7        nginx               "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/docker-entrypoint.…"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" seconds ago       Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" seconds        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8891-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   nginx002\nc315bcc94e9d        nginx               "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/docker-entrypoint.…"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" minutes ago       Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" minutes        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8890-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   nginx001\nb63169d43792        mysql:5.7.19        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker-entrypoint.s…"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" minutes ago       Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" minutes        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("/tcp               mysql_mysql.1.s75qe5kkpwwttyf0wrjvd2cda\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it f8682db35dd7 /bin/bash")]),s._v("\nroot@f8682db35dd7:/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl http://nginx001")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("DOCTYPE html"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("html"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("head"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("title"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("Welcome to nginx"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("/title"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br")])]),t("h3",{attrs:{id:"高级数据卷配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#高级数据卷配置"}},[s._v("#")]),s._v(" 高级数据卷配置")]),s._v(" "),t("h4",{attrs:{id:"说明-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#说明-2"}},[s._v("#")]),s._v(" 说明")]),s._v(" "),t("p",[t("code",[s._v("数据卷")]),s._v(" 是一个可供一个或多个容器使用的特殊目录，它绕过 UFS，可以提供很多有用的特性：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("数据卷")]),s._v(" 可以在容器之间共享和重用")]),s._v(" "),t("li",[s._v("对 "),t("code",[s._v("数据卷")]),s._v(" 的修改会立马生效")]),s._v(" "),t("li",[s._v("对 "),t("code",[s._v("数据卷")]),s._v(" 的更新，不会影响镜像")]),s._v(" "),t("li",[t("code",[s._v("数据卷")]),s._v(" 默认会一直存在，即使容器被删除")])]),s._v(" "),t("blockquote",[t("p",[s._v("注意："),t("code",[s._v("数据卷")]),s._v(" 的使用，类似于 Linux 下对目录或文件进行 mount，镜像中的被指定为挂载点的目录中的文件会复制到数据卷中（仅数据卷为空时会复制）。")])]),s._v(" "),t("h4",{attrs:{id:"创建数据卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建数据卷"}},[s._v("#")]),s._v(" 创建数据卷")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume create my-vol")]),s._v("\nmy-vol\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h4",{attrs:{id:"查看数据卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看数据卷"}},[s._v("#")]),s._v(" 查看数据卷")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker volume inspect my-vol       ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CreatedAt"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-11-25T11:43:56+08:00"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Labels"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mountpoint"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/docker/volumes/my-vol/_data"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"my-vol"')]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Options"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scope"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h4",{attrs:{id:"挂载数据卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#挂载数据卷"}},[s._v("#")]),s._v(" 挂载数据卷")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -P --name web  -v my-vol:/usr/share/nginx/html  nginx")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker inspect web")]),s._v("\n\t\t\t\t"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mounts"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Type"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"volume"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"my-vol"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Source"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/lib/docker/volumes/my-vol/_data"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Destination"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/share/nginx/html"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Driver"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"local"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Mode"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"z"')]),s._v(",\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RW"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n                "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Propagation"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("h4",{attrs:{id:"删除数据卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除数据卷"}},[s._v("#")]),s._v(" 删除数据卷")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" volume "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" my-vol\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"docker-compose"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[s._v("#")]),s._v(" Docker compose")]),s._v(" "),t("h3",{attrs:{id:"docker-compose使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose使用"}},[s._v("#")]),s._v(" docker compose使用")]),s._v(" "),t("h4",{attrs:{id:"_1-相关概念"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-相关概念"}},[s._v("#")]),s._v(" 1.相关概念")]),s._v(" "),t("p",[s._v("首先介绍几个术语。")]),s._v(" "),t("ul",[t("li",[s._v("服务 ("),t("code",[s._v("service")]),s._v(")：一个应用容器，实际上可以运行多个相同镜像的实例。")]),s._v(" "),t("li",[s._v("项目 ("),t("code",[s._v("project")]),s._v(")：由一组关联的应用容器组成的一个完整业务单元。∂一个项目可以由多个服务（容器）关联而成，"),t("code",[s._v("Compose")]),s._v(" 面向项目进行管理。")])]),s._v(" "),t("h4",{attrs:{id:"_2-场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-场景"}},[s._v("#")]),s._v(" 2.场景")]),s._v(" "),t("p",[s._v("最常见的项目是 web 网站，该项目应该包含 web 应用和缓存。")]),s._v(" "),t("ul",[t("li",[s._v("springboot应用")]),s._v(" "),t("li",[s._v("mysql服务")]),s._v(" "),t("li",[s._v("redis服务")]),s._v(" "),t("li",[s._v("elasticsearch服务")]),s._v(" "),t("li",[s._v(".......")])]),s._v(" "),t("h4",{attrs:{id:"_3-docker-compose模板"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-docker-compose模板"}},[s._v("#")]),s._v(" 3.docker-compose模板")]),s._v(" "),t("ul",[t("li",[s._v("参考文档:https://docker_practice.gitee.io/zh-cn/compose/compose_file.html")])]),s._v(" "),t("div",{staticClass:"language-yml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3.0"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mysqldb")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("5.7.19\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mysql\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3306:3306"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /root/mysql/conf"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/etc/mysql/conf.d\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /root/mysql/logs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/logs\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /root/mysql/data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/lib/mysql\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_ROOT_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ems\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" redis\n\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("4.0.14\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6379:6379"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ems\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /root/redis/data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/data\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server\n    \n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ems")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br")])]),t("h4",{attrs:{id:"_4-通过docker-compose运行一组容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-通过docker-compose运行一组容器"}},[s._v("#")]),s._v(" 4.通过docker-compose运行一组容器")]),s._v(" "),t("ul",[t("li",[s._v("参考文档:https://docker_practice.gitee.io/zh-cn/compose/commands.html")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose up    \t\t\t\t\t\t\t//前台启动一组服务")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker-compose up -d \t\t\t\t\t\t\t//后台启动一组服务")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("hr"),s._v(" "),t("h3",{attrs:{id:"docker-compose-模板文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-模板文件"}},[s._v("#")]),s._v(" docker-compose 模板文件")]),s._v(" "),t("p",[s._v("模板文件是使用 "),t("code",[s._v("Compose")]),s._v(" 的核心，涉及到的指令关键字也比较多。但大家不用担心，这里面大部分指令跟 "),t("code",[s._v("docker run")]),s._v(" 相关参数的含义都是类似的。")]),s._v(" "),t("p",[s._v("默认的模板文件名称为 "),t("code",[s._v("docker-compose.yml")]),s._v("，格式为 YAML 格式。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("webapp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" examples/web\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"80:80"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/data"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("注意每个服务都必须通过 "),t("code",[s._v("image")]),s._v(" 指令指定镜像或 "),t("code",[s._v("build")]),s._v(" 指令（需要 Dockerfile）等来自动构建生成镜像。")]),s._v(" "),t("p",[s._v("如果使用 "),t("code",[s._v("build")]),s._v(" 指令，在 "),t("code",[s._v("Dockerfile")]),s._v(" 中设置的选项(例如："),t("code",[s._v("CMD")]),s._v(", "),t("code",[s._v("EXPOSE")]),s._v(", "),t("code",[s._v("VOLUME")]),s._v(", "),t("code",[s._v("ENV")]),s._v(" 等) 将会自动被获取，无需在 "),t("code",[s._v("docker-compose.yml")]),s._v(" 中重复设置。")]),s._v(" "),t("p",[s._v("下面分别介绍各个指令的用法。")]),s._v(" "),t("h4",{attrs:{id:"build"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#build"}},[s._v("#")]),s._v(" "),t("code",[s._v("build")])]),s._v(" "),t("p",[s._v("指定 "),t("code",[s._v("Dockerfile")]),s._v(" 所在文件夹的路径（可以是绝对路径，或者相对 docker-compose.yml 文件的路径）。 "),t("code",[s._v("Compose")]),s._v(" 将会利用它自动构建这个镜像，然后使用这个镜像。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("webapp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./dir\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("你也可以使用 "),t("code",[s._v("context")]),s._v(" 指令指定 "),t("code",[s._v("Dockerfile")]),s._v(" 所在文件夹的路径。")]),s._v(" "),t("p",[s._v("使用 "),t("code",[s._v("dockerfile")]),s._v(" 指令指定 "),t("code",[s._v("Dockerfile")]),s._v(" 文件名。")]),s._v(" "),t("p",[s._v("使用 "),t("code",[s._v("arg")]),s._v(" 指令指定构建镜像时的变量。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("webapp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("context")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ./dir\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("dockerfile")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Dockerfile"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("alternate\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("args")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("buildno")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h4",{attrs:{id:"command"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#command"}},[s._v("#")]),s._v(" "),t("code",[s._v("command")])]),s._v(" "),t("p",[s._v("覆盖容器启动后默认执行的命令。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(' echo "hello world"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"container-name"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#container-name"}},[s._v("#")]),s._v(" "),t("code",[s._v("container_name")])]),s._v(" "),t("p",[s._v("指定容器名称。默认将会使用 "),t("code",[s._v("项目名称_服务名称_序号")]),s._v(" 这样的格式。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("container\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("注意: 指定容器名称后，该服务将无法进行扩展（scale），因为 Docker 不允许多个容器具有相同的名称。")])]),s._v(" "),t("h4",{attrs:{id:"depends-on"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#depends-on"}},[s._v("#")]),s._v(" "),t("code",[s._v("depends_on")])]),s._v(" "),t("p",[s._v("解决容器的依赖、启动先后的问题。以下例子中会先启动 "),t("code",[s._v("redis")]),s._v(" "),t("code",[s._v("db")]),s._v(" 再启动 "),t("code",[s._v("web")])]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("web")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("build")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" .\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("depends_on")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" db\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" redis\n\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("redis")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" redis\n\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("db")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" postgres\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("blockquote",[t("p",[s._v("注意："),t("code",[s._v("web")]),s._v(" 服务不会等待 "),t("code",[s._v("redis")]),s._v(" "),t("code",[s._v("db")]),s._v(" 「完全启动」之后才启动。")])]),s._v(" "),t("h4",{attrs:{id:"env-file"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#env-file"}},[s._v("#")]),s._v(" "),t("code",[s._v("env_file")])]),s._v(" "),t("p",[s._v("从文件中获取环境变量，可以为单独的文件路径或列表。")]),s._v(" "),t("p",[s._v("如果通过 "),t("code",[s._v("docker-compose -f FILE")]),s._v(" 方式来指定 Compose 模板文件，则 "),t("code",[s._v("env_file")]),s._v(" 中变量的路径会基于模板文件路径。")]),s._v(" "),t("p",[s._v("如果有变量名称与 "),t("code",[s._v("environment")]),s._v(" 指令冲突，则按照惯例，以后者为准。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("env_file: .env\n\nenv_file:\n  - ./common.env\n  - ./apps/web.env\n  - /opt/secrets.env\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("环境变量文件中每一行必须符合格式，支持 "),t("code",[s._v("#")]),s._v(" 开头的注释行。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# common.env: Set development environment")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PROG_ENV")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("development\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h4",{attrs:{id:"environment"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#environment"}},[s._v("#")]),s._v(" "),t("code",[s._v("environment")])]),s._v(" "),t("p",[s._v("设置环境变量。你可以使用数组或字典两种格式。")]),s._v(" "),t("p",[s._v("只给定名称的变量会自动获取运行 Compose 主机上对应变量的值，可以用来防止泄露不必要的数据。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("RACK_ENV")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" development\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("SESSION_SECRET")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" RACK_ENV=development\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" SESSION_SECRET\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("如果变量名称或者值中用到 "),t("code",[s._v("true|false，yes|no")]),s._v(" 等表达 "),t("a",{attrs:{href:"https://yaml.org/type/bool.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("布尔"),t("OutboundLink")],1),s._v(" 含义的词汇，最好放到引号里，避免 YAML 自动解析某些内容为对应的布尔语义。这些特定词汇，包括")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("y"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Y"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Yes"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("YES"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("N"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("no"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("No"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("NO"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("True"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("TRUE"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("False"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("FALSE"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("on"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("On"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("ON"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("off"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("Off"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("OFF\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"healthcheck"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#healthcheck"}},[s._v("#")]),s._v(" "),t("code",[s._v("healthcheck")])]),s._v(" "),t("p",[s._v("通过命令检查容器是否健康运行。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("healthcheck")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("test")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMD"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"curl"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-f"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://localhost"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("interval")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 1m30s\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("timeout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 10s\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("retries")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h4",{attrs:{id:"image"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#image"}},[s._v("#")]),s._v(" "),t("code",[s._v("image")])]),s._v(" "),t("p",[s._v("指定为镜像名称或镜像 ID。如果镜像在本地不存在，"),t("code",[s._v("Compose")]),s._v(" 将会尝试拉取这个镜像。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ubuntu\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" orchardup/postgresql\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" a4bc65fd\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h4",{attrs:{id:"networks"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#networks"}},[s._v("#")]),s._v(" "),t("code",[s._v("networks")])]),s._v(" "),t("p",[s._v("配置容器连接的网络。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("some-service")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" some"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("network\n     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" other"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("network\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("some-network")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("other-network")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h4",{attrs:{id:"ports"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ports"}},[s._v("#")]),s._v(" "),t("code",[s._v("ports")])]),s._v(" "),t("p",[s._v("暴露端口信息。")]),s._v(" "),t("p",[s._v("使用宿主端口：容器端口 "),t("code",[s._v("(HOST:CONTAINER)")]),s._v(" 格式，或者仅仅指定容器的端口（宿主将会随机选择端口）都可以。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3000"')]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8000:8000"')]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"49100:22"')]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1:8001:8001"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[t("em",[s._v("注意：当使用 "),t("code",[s._v("HOST:CONTAINER")]),s._v(" 格式来映射端口时，如果你使用的容器端口小于 60 并且没放到引号里，可能会得到错误结果，因为 "),t("code",[s._v("YAML")]),s._v(" 会自动解析 "),t("code",[s._v("xx:yy")]),s._v(" 这种数字格式为 60 进制。为避免出现这种问题，建议数字串都采用引号包括起来的字符串格式。")])]),s._v(" "),t("h4",{attrs:{id:"sysctls"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sysctls"}},[s._v("#")]),s._v(" "),t("code",[s._v("sysctls")])]),s._v(" "),t("p",[s._v("配置容器内核参数。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sysctls")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("net.core.somaxconn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("net.ipv4.tcp_syncookies")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("sysctls")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" net.core.somaxconn=1024\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" net.ipv4.tcp_syncookies=0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h4",{attrs:{id:"ulimits"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ulimits"}},[s._v("#")]),s._v(" "),t("code",[s._v("ulimits")])]),s._v(" "),t("p",[s._v("指定容器的 ulimits 限制值。")]),s._v(" "),t("p",[s._v("例如，指定最大进程数为 65535，指定文件句柄数为 20000（软限制，应用可以随时修改，不能超过硬限制） 和 40000（系统硬限制，只能 root 用户提高）。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ulimits")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nproc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("65535")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nofile")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("soft")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20000")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("hard")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("40000")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h4",{attrs:{id:"volumes"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#volumes"}},[s._v("#")]),s._v(" "),t("code",[s._v("volumes")])]),s._v(" "),t("p",[s._v("数据卷所挂载路径设置。可以设置为宿主机路径("),t("code",[s._v("HOST:CONTAINER")]),s._v(")或者数据卷名称("),t("code",[s._v("VOLUME:CONTAINER")]),s._v(")，并且可以设置访问模式 （"),t("code",[s._v("HOST:CONTAINER:ro")]),s._v("）。")]),s._v(" "),t("p",[s._v("该指令中路径支持相对路径。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" /var/lib/mysql\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" cache/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/tmp/cache\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ~/configs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/etc/configs/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("ro\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("如果路径为数据卷名称，必须在文件中配置数据卷。")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("my_src")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mysql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.0")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mysql_data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/lib/mysql\n\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("mysql_data")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("hr"),s._v(" "),t("h3",{attrs:{id:"docker-compose-常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-常用命令"}},[s._v("#")]),s._v(" docker-compose 常用命令")]),s._v(" "),t("h5",{attrs:{id:"_1-命令对象与格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-命令对象与格式"}},[s._v("#")]),s._v(" 1. 命令对象与格式")]),s._v(" "),t("p",[s._v("对于 Compose 来说，大部分命令的对象既可以是项目本身，也可以指定为项目中的服务或者容器。如果没有特别的说明，命令对象将是项目，这意味着项目中所有的服务都会受到命令影响。")]),s._v(" "),t("p",[s._v("执行 "),t("code",[s._v("docker-compose [COMMAND] --help")]),s._v(" 或者 "),t("code",[s._v("docker-compose help [COMMAND]")]),s._v(" 可以查看具体某个命令的使用格式。")]),s._v(" "),t("p",[t("code",[s._v("docker-compose")]),s._v(" 命令的基本的使用格式是")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-f"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("arg"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("COMMAND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("ARGS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h5",{attrs:{id:"_2-命令选项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-命令选项"}},[s._v("#")]),s._v(" 2. 命令选项")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-f, --file FILE")]),s._v(" 指定使用的 Compose 模板文件，默认为 "),t("code",[s._v("docker-compose.yml")]),s._v("，可以多次指定。")]),s._v(" "),t("li",[t("code",[s._v("-p, --project-name NAME")]),s._v(" 指定项目名称，默认将使用所在目录名称作为项目名。")]),s._v(" "),t("li",[t("code",[s._v("--x-networking")]),s._v(" 使用 Docker 的可拔插网络后端特性")]),s._v(" "),t("li",[t("code",[s._v("--x-network-driver DRIVER")]),s._v(" 指定网络后端的驱动，默认为 "),t("code",[s._v("bridge")])]),s._v(" "),t("li",[t("code",[s._v("--verbose")]),s._v(" 输出更多调试信息。")]),s._v(" "),t("li",[t("code",[s._v("-v, --version")]),s._v(" 打印版本并退出。")])]),s._v(" "),t("h5",{attrs:{id:"_3-命令使用说明"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-命令使用说明"}},[s._v("#")]),s._v(" 3.命令使用说明")]),s._v(" "),t("h5",{attrs:{id:"up"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#up"}},[s._v("#")]),s._v(" "),t("code",[s._v("up")])]),s._v(" "),t("p",[s._v("格式为 "),t("code",[s._v("docker-compose up [options] [SERVICE...]")]),s._v("。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("该命令十分强大，它将尝试自动完成包括构建镜像，（重新）创建服务，启动服务，并关联服务相关容器的一系列操作。")])]),s._v(" "),t("li",[t("p",[s._v("链接的服务都将会被自动启动，除非已经处于运行状态。")])]),s._v(" "),t("li",[t("p",[s._v("可以说，大部分时候都可以直接通过该命令来启动一个项目。")])]),s._v(" "),t("li",[t("p",[s._v("默认情况，"),t("code",[s._v("docker-compose up")]),s._v(" 启动的容器都在前台，控制台将会同时打印所有容器的输出信息，可以很方便进行调试。")])]),s._v(" "),t("li",[t("p",[s._v("当通过 "),t("code",[s._v("Ctrl-C")]),s._v(" 停止命令时，所有容器将会停止。")])]),s._v(" "),t("li",[t("p",[s._v("如果使用 "),t("code",[s._v("docker-compose up -d")]),s._v("，将会在后台启动并运行所有的容器。一般推荐生产环境下使用该选项。")])]),s._v(" "),t("li",[t("p",[s._v("默认情况，如果服务容器已经存在，"),t("code",[s._v("docker-compose up")]),s._v(" 将会尝试停止容器，然后重新创建（保持使用 "),t("code",[s._v("volumes-from")]),s._v(" 挂载的卷），以保证新启动的服务匹配 "),t("code",[s._v("docker-compose.yml")]),s._v(" 文件的最新内容")])])]),s._v(" "),t("hr"),s._v(" "),t("h5",{attrs:{id:"down"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#down"}},[s._v("#")]),s._v(" "),t("code",[s._v("down")])]),s._v(" "),t("ul",[t("li",[s._v("此命令将会停止 "),t("code",[s._v("up")]),s._v(" 命令所启动的容器，并移除网络")])]),s._v(" "),t("hr"),s._v(" "),t("h5",{attrs:{id:"exec"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#exec"}},[s._v("#")]),s._v(" "),t("code",[s._v("exec")])]),s._v(" "),t("ul",[t("li",[s._v("进入指定的容器。")])]),s._v(" "),t("hr"),s._v(" "),t("h5",{attrs:{id:"ps"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ps"}},[s._v("#")]),s._v(" "),t("code",[s._v("ps")])]),s._v(" "),t("p",[s._v("格式为 "),t("code",[s._v("docker-compose ps [options] [SERVICE...]")]),s._v("。")]),s._v(" "),t("p",[s._v("列出项目中目前的所有容器。")]),s._v(" "),t("p",[s._v("选项：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-q")]),s._v(" 只打印容器的 ID 信息。")])]),s._v(" "),t("hr"),s._v(" "),t("h5",{attrs:{id:"restart"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#restart"}},[s._v("#")]),s._v(" "),t("code",[s._v("restart")])]),s._v(" "),t("p",[s._v("格式为 "),t("code",[s._v("docker-compose restart [options] [SERVICE...]")]),s._v("。")]),s._v(" "),t("p",[s._v("重启项目中的服务。")]),s._v(" "),t("p",[s._v("选项：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-t, --timeout TIMEOUT")]),s._v(" 指定重启前停止容器的超时（默认为 10 秒）。")])]),s._v(" "),t("hr"),s._v(" "),t("h5",{attrs:{id:"rm"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rm"}},[s._v("#")]),s._v(" "),t("code",[s._v("rm")])]),s._v(" "),t("p",[s._v("格式为 "),t("code",[s._v("docker-compose rm [options] [SERVICE...]")]),s._v("。")]),s._v(" "),t("p",[s._v("删除所有（停止状态的）服务容器。推荐先执行 "),t("code",[s._v("docker-compose stop")]),s._v(" 命令来停止容器。")]),s._v(" "),t("p",[s._v("选项：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-f, --force")]),s._v(" 强制直接删除，包括非停止状态的容器。一般尽量不要使用该选项。")]),s._v(" "),t("li",[t("code",[s._v("-v")]),s._v(" 删除容器所挂载的数据卷。")])]),s._v(" "),t("hr"),s._v(" "),t("h5",{attrs:{id:"start"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#start"}},[s._v("#")]),s._v(" "),t("code",[s._v("start")])]),s._v(" "),t("p",[s._v("格式为 "),t("code",[s._v("docker-compose start [SERVICE...]")]),s._v("。")]),s._v(" "),t("p",[s._v("启动已经存在的服务容器。")]),s._v(" "),t("hr"),s._v(" "),t("h5",{attrs:{id:"stop"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#stop"}},[s._v("#")]),s._v(" "),t("code",[s._v("stop")])]),s._v(" "),t("p",[s._v("格式为 "),t("code",[s._v("docker-compose stop [options] [SERVICE...]")]),s._v("。")]),s._v(" "),t("p",[s._v("停止已经处于运行状态的容器，但不删除它。通过 "),t("code",[s._v("docker-compose start")]),s._v(" 可以再次启动这些容器。")]),s._v(" "),t("p",[s._v("选项：")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-t, --timeout TIMEOUT")]),s._v(" 停止容器时候的超时（默认为 10 秒）。")])]),s._v(" "),t("hr"),s._v(" "),t("h5",{attrs:{id:"top"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#top"}},[s._v("#")]),s._v(" "),t("code",[s._v("top")])]),s._v(" "),t("p",[s._v("查看各个服务容器内运行的进程。")]),s._v(" "),t("hr"),s._v(" "),t("h5",{attrs:{id:"unpause"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#unpause"}},[s._v("#")]),s._v(" "),t("code",[s._v("unpause")])]),s._v(" "),t("p",[s._v("格式为 "),t("code",[s._v("docker-compose unpause [SERVICE...]")]),s._v("。")]),s._v(" "),t("p",[s._v("恢复处于暂停状态中的服务。")]),s._v(" "),t("hr"),s._v(" "),t("h2",{attrs:{id:"docker可视化工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker可视化工具"}},[s._v("#")]),s._v(" docker可视化工具")]),s._v(" "),t("h4",{attrs:{id:"安装portainer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装portainer"}},[s._v("#")]),s._v(" 安装Portainer")]),s._v(" "),t("p",[s._v("官方安装说明："),t("a",{attrs:{href:"http://www.yunweipai.com/go?_=8fe4813824aHR0cHM6Ly93d3cucG9ydGFpbmVyLmlvL2luc3RhbGxhdGlvbi8=",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.portainer.io/installation/"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ubuntu1804 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker pull  portainer/portainer")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ubuntu1804 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker volume create portainer_data")]),s._v("\nportainer_data\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ubuntu1804 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker run -d -p 8000:8000 -p 9000:9000 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer")]),s._v("\n20db26b67b791648c2ef6aee444a5226a9c897ebcf0160050e722dbf4a4906e3\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@ubuntu1804 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker ps ")]),s._v("\nCONTAINER ID        IMAGE                 COMMAND             CREATED             STATUS              PORTS                                            NAMES\n20db26b67b79        portainer/portainer   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/portainer"')]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" seconds ago       Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" seconds        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:8000-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("/tcp, "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:9000-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9000")]),s._v("/tcp   portainer\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h4",{attrs:{id:"登录和使用portainer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#登录和使用portainer"}},[s._v("#")]),s._v(" 登录和使用Portainer")]),s._v(" "),t("blockquote",[t("p",[s._v("用浏览器访问："),t("code",[s._v("http://localhost:9000")])])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://wiki-1251603812.cos.ap-shanghai.myqcloud.com/images/image-20220501142933527.png",alt:"image-20220501142933527"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);